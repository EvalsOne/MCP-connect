# MCP Connect

    â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
    â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
    â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   
    â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â•     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   
    â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘         â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   
    â•šâ•â•     â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•          â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•   â•šâ•â•   


<div align="center">

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Node.js Version](https://img.shields.io/badge/node-%3E%3D20.0.0-brightgreen)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.4+-blue)](https://www.typescriptlang.org/)

**å°† MCP æœåŠ¡å™¨è½¬æ¢ä¸º HTTP API çš„è½»é‡çº§æ¡¥æ¥æœåŠ¡**

[English](../README.md) â€¢ [ç®€ä½“ä¸­æ–‡](README.zh-CN.md)

</div>

---

## ğŸ“– ä»€ä¹ˆæ˜¯ MCP Connectï¼Ÿ

MCP Connect æ˜¯ä¸€ä¸ª HTTP ç½‘å…³æœåŠ¡ï¼Œè®©ä½ å¯ä»¥é€šè¿‡Streamable HTTP æ–¹å¼è°ƒç”¨ä½¿ç”¨ Stdio é€šä¿¡åè®®çš„æœ¬åœ° MCP æœåŠ¡å™¨ã€‚

### æœ€æ–°æ›´æ–°

- åœ¨ç»å…¸è¯·æ±‚/å“åº”æ¡¥æ¥ä¹‹ä¸Šæ–°å¢ Streamable HTTP æ¨¡å¼
- åœ¨ `deploy/e2b` ä¸‹æ–°å¢å¿«é€Ÿéƒ¨ç½²è„šæœ¬ä¸é…ç½®ï¼Œç”¨äºåœ¨ E2B æ²™ç®±ä¸­å¯åŠ¨

## å·¥ä½œåŸç†

```
+-----------------+   HTTP (JSON)               +------------------+      stdio      +------------------+
|                 |   /bridge                   |                  |                 |                  |
|  Cloud AI tools | <------------------------>  |  Node.js Bridge  | <------------>  |    MCP Server    |
|   (Remote)      |                             |    (Local)       |                 |     (Local)      |
|                 |   HTTP (SSE stream)         |                  |                 |                  |
|                 |   /mcp/:serverId            |                  |                 |                  |
+-----------------+         Tunnels (optional)  +------------------+                 +------------------+
```

**âœ¨ æ ¸å¿ƒç‰¹æ€§**

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| ğŸš€ **åŒæ¨¡å¼æ”¯æŒ** | å¯ä½¿ç”¨ Streamable HTTP æˆ–è€…ç»å…¸ HTTP æ¡¥æ¥æ–¹å¼è°ƒç”¨æœ¬åœ°Stdioåè®®çš„MCPæœåŠ¡å™¨ |
| ğŸ”„ **Sessionç®¡ç†** | æ”¯æŒé€šè¿‡Sessionæœºåˆ¶ç»´æŠ¤å¯¹è¯çš„è¿ç»­æ€§ |
| ğŸ” **å®‰å…¨é˜²æŠ¤** | Bearer Token è®¤è¯ + CORS ç™½åå• |
| ğŸŒ **å…¬ç½‘è®¿é—®** | å†…ç½® Ngrok éš§é“ï¼Œä¸€é”®æš´éœ²å¤–ç½‘ |
| â˜ï¸ **äº‘ç«¯éƒ¨ç½²** | ä¸€é”®éƒ¨ç½²åˆ° E2B äº‘æ²™ç®± |
---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js >= 22.0.0 (æ¨è)
- npm æˆ– yarn

### 1ï¸âƒ£ å®‰è£…

```bash
git clone https://github.com/EvalsOne/MCP-connect.git
cd mcp-connect
npm install
```

### 2ï¸âƒ£ é…ç½®

**æ­¥éª¤ Aï¼šè®¾ç½®ç¯å¢ƒå˜é‡**

```bash
cp .env.example .env
vim .env  # ç¼–è¾‘é…ç½®
```

```env
# æœåŠ¡ç«¯å£
PORT=3000

# è®¿é—®ä»¤ç‰Œï¼ˆå¼ºçƒˆå»ºè®®è®¾ç½®ï¼ï¼‰
ACCESS_TOKEN=your-secret-token-here

# å¯é€‰ï¼šNgrok ä»¤ç‰Œï¼ˆç”¨äºå¤–ç½‘è®¿é—®ï¼‰
NGROK_AUTH_TOKEN=your-ngrok-token
```

**æ­¥éª¤ Bï¼šé…ç½® MCP æœåŠ¡å™¨**ï¼ˆæ¨èä½¿ç”¨ YAMLï¼‰

```bash
cp mcp-servers.example.json mcp-servers.json
vim mcp-servers.json  # ç¼–è¾‘é…ç½®
```

```json
{
  "mcpServers": {
    "fetch": {
      "command": "uvx",
      "args": ["mcp-server-fetch"],
    "description": "HTTP/HTTPS å†…å®¹æŠ“å–å™¨"
    }
  },
  ......
}
```

### 3ï¸âƒ£ å¯åŠ¨

```bash
# æ„å»ºå¹¶å¯åŠ¨
npm run build
npm start

# æˆ–ä½¿ç”¨å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run dev

# å¯ç”¨ Ngrok éš§é“
npm run start:tunnel
```

çœ‹åˆ°å¯åŠ¨æ¨ªå¹…åï¼Œè®¿é—® http://localhost:3000/health æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼


---

## ğŸ“š ä½¿ç”¨æŒ‡å—

### æ¨¡å¼ä¸€ï¼šStreamable HTTPæ–¹å¼

é€šç”¨å‹æ›´å¼ºï¼Œå¯ä»¥è¢«ä»»ä½•æ”¯æŒ Steamable http åè®®çš„ MCP å®¢æˆ·ç«¯è°ƒç”¨ã€‚å¦‚ï¼šClaude Code, Cursor, Codex, Github Copilotç­‰ã€‚

Streamable HTTPæ–¹å¼ä¸­ï¼Œæ¯ä¸ªMCP Serveréƒ½å°†é€šè¿‡è·¯ç”±æœºåˆ¶åˆ†é…å”¯ä¸€çš„URLåœ°å€å¯ä¾›è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š

åœ¨ mcp-servers.json ä¸­å¢åŠ å¯¹äºfetch MCP serverçš„æ”¯æŒã€‚

```json
{
  "mcpServers": {
    "fetch": {
      "command": "uvx",
      "args": ["mcp-server-fetch"],
      "description": "HTTP/HTTPS å†…å®¹æŠ“å–å™¨"
    }
  }
}
```

å¯åŠ¨æˆåŠŸåï¼Œå³å¯é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®fetch MCP serverï¼š

```
http://localhost:3000/mcp/fetch
```

âš ï¸ æ³¨æ„ï¼šå¿…é¡»åœ¨å¯åŠ¨å‰é€šè¿‡mcp-servers.jsonè¿›è¡Œé…ç½®ï¼Œå¦åˆ™å°†æ— æ³•ä½¿ç”¨ã€‚

---

### æ¨¡å¼äºŒï¼šç»å…¸æ¡¥æ¥æ–¹å¼ (å…¼å®¹ä¹‹å‰çš„æ—§æ–¹å¼)

éå®˜æ–¹æ ‡å‡†çš„è°ƒç”¨æ–¹å¼ï¼Œéœ€è¦è‡ªå·±å®ç° tools/list, tools/call ç­‰å…·ä½“çš„æ–¹æ³•

#### ç¤ºä¾‹ 1ï¼šåˆ—å‡ºå¯ç”¨å·¥å…·

```bash
curl -X POST http://localhost:3000/bridge \
  -H "Authorization: Bearer your-secret-token-here" \
  -H "Content-Type: application/json" \
  -d '{
    "serverPath": "uvx",
    "args": ["mcp-server-fetch"],
    "method": "tools/list",
    "params": {}
  }'
```

#### ç¤ºä¾‹ 2ï¼šè°ƒç”¨å·¥å…·

```bash
curl -X POST http://localhost:3000/bridge \
  -H "Authorization: Bearer your-secret-token-here" \
  -H "Content-Type: application/json" \
  -d '{
    "serverPath": "uvx",
    "args": ["mcp-server-fetch"],
    "method": "tools/call",
    "params": {
      "name": "fetch",
      "arguments": {
        "url": "https://example.com"
      }
    }
  }'
```

### åŠ å¯†ä¸å®‰å…¨

#### è®¤è¯ï¼ˆAuthenticationï¼‰
MCP Connect ä½¿ç”¨ç®€å•çš„ä»¤ç‰Œè®¤è¯æœºåˆ¶ã€‚ä»¤ç‰Œå­˜å‚¨åœ¨ `.env` æ–‡ä»¶ä¸­ã€‚è®¾ç½®ä»¤ç‰Œåï¼ŒMCP Connect å°†ä½¿ç”¨è¯¥ä»¤ç‰Œæ ¡éªŒè¯·æ±‚ã€‚

```bash
Authorization: Bearer <your_auth_token>
```

#### å…è®¸çš„æ¥æºï¼ˆAllowed Originsï¼‰
åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œå»ºè®®åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½® `ALLOWED_ORIGINS`ï¼Œé™åˆ¶è·¨åŸŸè¯·æ±‚çš„æ¥æºï¼š

```env
ALLOWED_ORIGINS=https://yourdomain.com,https://app.yourdomain.com
```

å¦‚æœè®¾ç½®äº† ALLOWED_ORIGINSï¼Œä¸åŒ¹é…çš„è®¿é—®æºå°†è¢«æ‹’ç»ã€‚

---

## ğŸ› ï¸ API å‚è€ƒ

### `GET /health`

å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼ˆæ— éœ€è®¤è¯ï¼‰

**å“åº”**ï¼š
```json
{"status": "ok"}
```

---


### `POST /mcp/:serverId`

æµå¼ä¼šè¯æ¨¡å¼

**è·¯å¾„å‚æ•°**ï¼š
- `serverId`ï¼šåœ¨ `MCP_SERVERS` ä¸­å®šä¹‰çš„æœåŠ¡å™¨ ID

**è¯·æ±‚å¤´**ï¼š
- `Authorization: Bearer <token>`ï¼ˆå¦‚å·²è®¾ç½® `ACCESS_TOKEN`ï¼‰
- `Accept: application/json, text/event-stream`ï¼ˆå¿…é¡»ï¼‰
- `mcp-session-id: <session-id>`ï¼ˆå¯é€‰ï¼Œå¤ç”¨å·²æœ‰ä¼šè¯ï¼‰

**è¯·æ±‚ä½“**ï¼š
```json
[
  {"jsonrpc":"2.0","id":"1","method":"tools/list","params":{}},
  {"jsonrpc":"2.0","method":"notifications/initialized"}
]
```

---

### `POST /bridge`

åŸæ¡¥æ¥æ¨¡å¼

**è¯·æ±‚å¤´**ï¼š
- `Authorization: Bearer <token>`ï¼ˆå¦‚å·²è®¾ç½® `ACCESS_TOKEN`ï¼‰
- `Content-Type: application/json`

**è¯·æ±‚ä½“**ï¼š
```json
{
  "serverPath": "å¯æ‰§è¡Œå‘½ä»¤æˆ– URLï¼ˆhttp/https/ws/wssï¼‰",
  "method": "JSON-RPC æ–¹æ³•å",
  "params": {},
  "args": ["å¯é€‰çš„å‘½ä»¤è¡Œå‚æ•°"],
  "env": {"å¯é€‰çš„ç¯å¢ƒå˜é‡": "å€¼"}
}
```

**æ”¯æŒçš„æ–¹æ³•**ï¼š
- `tools/list`ã€`tools/call`
- `prompts/list`ã€`prompts/get`
- `resources/list`ã€`resources/read`
- `resources/subscribe`ã€`resources/unsubscribe`
- `completion/complete`
- `logging/setLevel`

---

## ğŸŒ é€šè¿‡Ngrokæä¾›å¤–ç½‘è®¿é—®éš§é“

1. è·å– Ngrok ä»¤ç‰Œï¼šhttps://dashboard.ngrok.com/get-started/your-authtoken

2. æ·»åŠ åˆ° `.env`ï¼š
   ```env
   NGROK_AUTH_TOKEN=your-token-here
   ```

3. å¯åŠ¨æœåŠ¡ï¼š
   ```bash
   npm run start:tunnel
   ```

4. æ§åˆ¶å°ä¼šæ˜¾ç¤ºå…¬ç½‘åœ°å€ï¼š
   ```
   Tunnel URL: https://abc123.ngrok.io
   MCP Bridge URL: https://abc123.ngrok.io/bridge
   ```

---

## ğŸŒ å¿«é€Ÿéƒ¨ç½²åˆ° E2B äº‘æ²™ç®±

> E2B æä¾›éš”ç¦»çš„äº‘ç«¯æ²™ç®±ç¯å¢ƒï¼Œé€‚åˆåœ¨å®‰å…¨ç¯å¢ƒä¸­è¿è¡Œä¸å—ä¿¡ä»»çš„ MCP æœåŠ¡å™¨ã€‚

### æ­¥éª¤ 1ï¸âƒ£ï¼šå‡†å¤‡ E2B ç¯å¢ƒ

```bash
# æ³¨å†Œ E2B è´¦å·
è®¿é—® https://e2b.dev å¹¶è·å– API Key

# å®‰è£… E2B CLI
pip install e2b

# è®¾ç½® API Key
export E2B_API_KEY=your-e2b-api-key
```

### æ­¥éª¤ 2ï¸âƒ£ï¼šæ„å»ºæ²™ç®±æ¨¡æ¿

```bash
cd deploy/e2b

# å¼€å‘ç¯å¢ƒ
python build_dev.py

# æˆ–ç”Ÿäº§ç¯å¢ƒ
python build_prod.py
```

### æ­¥éª¤ 3ï¸âƒ£ï¼šä»æ¨¡ç‰ˆå¯åŠ¨æ²™ç›’

```bash
python sandbox_deploy.py --template-id mcp-dev-gui
```

è¯¦ç»†æ–‡æ¡£ï¼š[E2B éƒ¨ç½²æŒ‡å—](docs/deployment-guide.md#e2b-æ²™ç®±éƒ¨ç½²)

---

## ğŸ“Š æ—¥å¿—ä¸ç›‘æ§

### æ—¥å¿—æ–‡ä»¶

- `combined.log`ï¼šæ‰€æœ‰çº§åˆ«æ—¥å¿—
- `error.log`ï¼šä»…é”™è¯¯çº§åˆ«

### æ—¥å¿—çº§åˆ«

é€šè¿‡ `LOG_LEVEL` æ§åˆ¶è¯¦ç»†ç¨‹åº¦ï¼š

```env
LOG_LEVEL=DEBUG  # å¼€å‘ç¯å¢ƒ
LOG_LEVEL=INFO   # ç”Ÿäº§ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰
LOG_LEVEL=WARN   # ä»…è­¦å‘Šå’Œé”™è¯¯
```

---

## ğŸ§ª å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ server/
â”‚   â””â”€â”€ http-server.ts      # HTTP æœåŠ¡å™¨å’Œè·¯ç”±
â”œâ”€â”€ client/
â”‚   â””â”€â”€ mcp-client-manager.ts  # MCP å®¢æˆ·ç«¯ç®¡ç†
â”œâ”€â”€ stream/
â”‚   â”œâ”€â”€ session-manager.ts   # ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚   â””â”€â”€ stream-session.ts    # SSE ä¼šè¯å®ç°
â”œâ”€â”€ config/
â”‚   â””â”€â”€ config.ts            # é…ç½®åŠ è½½å’Œæ ¡éªŒ
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ logger.ts            # Winston æ—¥å¿—å™¨
â”‚   â””â”€â”€ tunnel.ts            # Ngrok éš§é“ç®¡ç†
â””â”€â”€ index.ts                 # å…¥å£æ–‡ä»¶
```

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

<div align="center">

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª â­ï¸ Starï¼**

</div>

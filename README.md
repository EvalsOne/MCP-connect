# MCP Connect

    â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
    â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
    â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   
    â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â•     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   
    â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘         â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   
    â•šâ•â•     â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•          â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•   â•šâ•â•   


<div align="center">

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Node.js Version](https://img.shields.io/badge/node-%3E%3D20.0.0-brightgreen)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.4+-blue)](https://www.typescriptlang.org/)

**å°† MCP æœåŠ¡å™¨è½¬æ¢ä¸º HTTP API çš„è½»é‡çº§æ¡¥æ¥æœåŠ¡**

[English](#) â€¢ [ç®€ä½“ä¸­æ–‡](#)

</div>

---

## ğŸ“– ä»€ä¹ˆæ˜¯ MCP Connectï¼Ÿ

MCP Connect æ˜¯ä¸€ä¸ª HTTP ç½‘å…³æœåŠ¡ï¼Œè®©ä½ å¯ä»¥é€šè¿‡ HTTP æ–¹å¼è°ƒç”¨ä½¿ç”¨ Stdio é€šä¿¡åè®®çš„æœ¬åœ° MCP æœåŠ¡å™¨ã€‚

### æœ€æ–°æ›´æ–°

- Added Streamable HTTP mode on top of the classic request/response bridge
- New quick-deploy scripts and configs under `deploy/e2b` for launching in an E2B sandbox

## å·¥ä½œåŸç†

```
+-----------------+   HTTP (JSON)               +------------------+      stdio      +------------------+
|                 |   /bridge                   |                  |                 |                  |
|  Cloud AI tools | <------------------------>  |  Node.js Bridge  | <------------>  |    MCP Server    |
|   (Remote)      |                             |    (Local)       |                 |     (Local)      |
|                 |   HTTP (SSE stream)         |                  |                 |                  |
|                 |   /mcp/:serverId            |                  |                 |                  |
+-----------------+         Tunnels (optional)  +------------------+                 +------------------+
```

**âœ¨ æ ¸å¿ƒç‰¹æ€§**

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| ğŸš€ **åŒæ¨¡å¼æ”¯æŒ** | å¯ä½¿ç”¨ Streamable HTTP æˆ–è€…ç»å…¸ HTTP æ¡¥æ¥æ–¹å¼è°ƒç”¨ |
| ğŸ”„ **Sessionç®¡ç†** | æ”¯æŒé€šè¿‡Sessionæœºåˆ¶ç»´æŠ¤å¯¹è¯çš„è¿ç»­æ€§ |
| ğŸ” **å®‰å…¨é˜²æŠ¤** | Bearer Token è®¤è¯ + CORS ç™½åå• |
| ğŸŒ **å…¬ç½‘è®¿é—®** | å†…ç½® Ngrok éš§é“ï¼Œä¸€é”®æš´éœ²å¤–ç½‘ |
| â˜ï¸ **äº‘ç«¯éƒ¨ç½²** | ä¸€é”®éƒ¨ç½²åˆ° E2B äº‘æ²™ç®±ï¼ˆå®‰å…¨éš”ç¦»ï¼‰ |
---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js >= 20.0.0
- npm æˆ– yarn

### 1ï¸âƒ£ å®‰è£…

```bash
git clone https://github.com/EvalsOne/MCP-connect.git
cd mcp-connect
npm install
```

### 2ï¸âƒ£ é…ç½®

**æ­¥éª¤ Aï¼šè®¾ç½®ç¯å¢ƒå˜é‡**

```bash
cp .env.example .env
vim .env  # ç¼–è¾‘é…ç½®
```

```env
# æœåŠ¡ç«¯å£
PORT=3000

# è®¿é—®ä»¤ç‰Œï¼ˆå¼ºçƒˆå»ºè®®è®¾ç½®ï¼ï¼‰
ACCESS_TOKEN=your-secret-token-here

# å¯é€‰ï¼šNgrok ä»¤ç‰Œï¼ˆç”¨äºå¤–ç½‘è®¿é—®ï¼‰
NGROK_AUTH_TOKEN=your-ngrok-token
```

**æ­¥éª¤ Bï¼šé…ç½® MCP æœåŠ¡å™¨**ï¼ˆæ¨èä½¿ç”¨ YAMLï¼‰

```bash
cp mcp-servers.example.yaml mcp-servers.yaml
vim mcp-servers.yaml  # ç¼–è¾‘é…ç½®
```

```yaml
servers:
  fetch:
    command: uvx
    args: [mcp-server-fetch]
    description: "HTTP å†…å®¹æŠ“å–"
```

<details>
<summary>æˆ–ä½¿ç”¨ç¯å¢ƒå˜é‡æ–¹å¼ï¼ˆé€‚åˆç®€å•åœºæ™¯ï¼‰</summary>

åœ¨ `.env` ä¸­æ·»åŠ ï¼š

```env
MCP_SERVERS={"fetch":{"command":"uvx","args":["mcp-server-fetch"]}}
```

</details>

### 3ï¸âƒ£ å¯åŠ¨

```bash
# æ„å»ºå¹¶å¯åŠ¨
npm run build
npm start

# æˆ–ä½¿ç”¨å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run dev

# å¯ç”¨ Ngrok éš§é“
npm run start:tunnel
```

çœ‹åˆ°å¯åŠ¨æ¨ªå¹…åï¼Œè®¿é—® http://localhost:3000/health æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼

### ğŸŒ å¿«é€Ÿéƒ¨ç½²åˆ° E2B äº‘æ²™ç®±

> E2B æä¾›éš”ç¦»çš„äº‘ç«¯æ²™ç®±ç¯å¢ƒï¼Œé€‚åˆè¿è¡Œä¸å—ä¿¡ä»»çš„ MCP æœåŠ¡å™¨ã€‚

#### æ­¥éª¤ 1ï¸âƒ£ï¼šå‡†å¤‡ E2B ç¯å¢ƒ

```bash
# æ³¨å†Œ E2B è´¦å·
è®¿é—® https://e2b.dev å¹¶è·å– API Key

# å®‰è£… E2B CLI
pip install e2b

# è®¾ç½® API Key
export E2B_API_KEY=your-e2b-api-key
```

#### æ­¥éª¤ 2ï¸âƒ£ï¼šæ„å»ºæ²™ç®±æ¨¡æ¿

```bash
cd deploy/e2b

# å¼€å‘ç¯å¢ƒ
make e2b:build:dev

# æˆ–ç”Ÿäº§ç¯å¢ƒ
make e2b:build:prod
```

æ„å»ºå®Œæˆåä¼šæ˜¾ç¤ºæ¨¡æ¿ IDï¼Œä¾‹å¦‚ï¼š`mcp-xyz123`

#### æ­¥éª¤ 3ï¸âƒ£ï¼šåœ¨ä»£ç ä¸­ä½¿ç”¨

```python
from e2b import AsyncSandbox
import asyncio

async def main():
    # åˆ›å»ºæ²™ç®±ï¼ˆ3 ç§’å†…å¯åŠ¨ï¼‰
    sandbox = await AsyncSandbox.create('mcp-xyz123')

    # å¯åŠ¨ MCP Bridge æœåŠ¡
    await sandbox.process.start("cd /app && npm start")

    # ä½¿ç”¨æ²™ç®±ä¸­çš„æœåŠ¡...
    # è¯¦è§ docs/deployment-guide.md

    await sandbox.kill()

asyncio.run(main())
```

**E2B ä¼˜åŠ¿**ï¼š
- âœ… å®Œå…¨éš”ç¦»ï¼ˆå®‰å…¨è¿è¡Œç¬¬ä¸‰æ–¹ä»£ç ï¼‰
- âœ… å¿«é€Ÿå¯åŠ¨ï¼ˆ< 3 ç§’ï¼‰
- âœ… æŒ‰éœ€æ‰©å®¹
- âœ… é¢„è£… Node.js + Python + uvx

è¯¦ç»†æ–‡æ¡£ï¼š[E2B éƒ¨ç½²æŒ‡å—](docs/deployment-guide.md#e2b-æ²™ç®±éƒ¨ç½²)

---

## ğŸ“š ä½¿ç”¨æŒ‡å—

### æ¨¡å¼ä¸€ï¼šStreamable HTTPæ–¹å¼

é€šç”¨å‹æ›´å¼ºï¼Œå¯ä»¥è¢«ä»»ä½•æ”¯æŒ Steamable http åè®®çš„ MCP å®¢æˆ·ç«¯è°ƒç”¨ã€‚

#### æ­¥éª¤ 1ï¼šé…ç½®æœåŠ¡å™¨

**æ¨èæ–¹å¼ï¼šä½¿ç”¨ YAML é…ç½®æ–‡ä»¶** â­

åˆ›å»º `mcp-servers.yaml`ï¼š

```yaml
servers:
  fetch:
    command: uvx
    args:
      - mcp-server-fetch
    description: "HTTP/HTTPS å†…å®¹æŠ“å–å·¥å…·"

  filesystem:
    command: npx
    args:
      - -y
      - "@modelcontextprotocol/server-filesystem"
      - /tmp
    description: "è®¿é—® /tmp ç›®å½•"

  github:
    command: npx
    args:
      Or directly with Python scripts (now with selectable Dockerfile & alias):
      ```bash
      # Dev (default full Dockerfile)
      python deploy/e2b/build_dev.py --dockerfile e2b.Dockerfile --alias mcp-dev-gui

      # Dev using minimal Dockerfile variant
      python deploy/e2b/build_dev.py --dockerfile e2b.Dockerfile.minimal --alias mcp-dev-mini

      # Prod (skip-cache on, can override)
      python deploy/e2b/build_prod.py --dockerfile e2b.Dockerfile --alias mcp-prod-gui --skip-cache
      ```
      - -y
      - "@modelcontextprotocol/server-github"
    env:
      # å®‰å…¨å¼•ç”¨ç¯å¢ƒå˜é‡
      GITHUB_PERSONAL_ACCESS_TOKEN: ${GITHUB_TOKEN}
    description: "GitHub API é›†æˆ"
```

ç„¶ååœ¨ `.env` ä¸­è®¾ç½®æ•æ„Ÿä¿¡æ¯ï¼š

```env
```bash
# Default (uses built-in template id fallback)
python deploy/e2b/e2b_sandbox_manager.py

# Specify a template ID or alias produced from build scripts
python deploy/e2b/e2b_sandbox_manager.py --template-id <template-or-alias> --sandbox-id my_sandbox

# Fast create without waiting health + no internet
python deploy/e2b/e2b_sandbox_manager.py --template-id <template-or-alias> --no-wait --no-internet
```
GITHUB_TOKEN=ghp_your_token_here
```

<details>
<summary><b>æ–¹å¼ 2ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆç®€å•åœºæ™¯ï¼‰</b></summary>

åœ¨ `.env` ä¸­æ·»åŠ æœåŠ¡å™¨å®šä¹‰ï¼š

```env
MCP_SERVERS={"fetch":{"command":"uvx","args":["mcp-server-fetch"]},"filesystem":{"command":"npx","args":["-y","@modelcontextprotocol/server-filesystem","/tmp"]}}
```

**æ³¨æ„**ï¼šç¯å¢ƒå˜é‡æ–¹å¼é€‚åˆç®€å•é…ç½®ï¼Œå¤æ‚åœºæ™¯å»ºè®®ä½¿ç”¨ YAML æ–‡ä»¶ã€‚

</details>

> ğŸ’¡ **æç¤º**ï¼š
> - YAML æ–‡ä»¶æ›´æ˜“è¯»ã€æ”¯æŒæ³¨é‡Šã€ç‰ˆæœ¬æ§åˆ¶å‹å¥½
> - æ”¯æŒç¯å¢ƒå˜é‡å¼•ç”¨ï¼š`${VAR_NAME}` è¯­æ³•
> - è¯¦ç»†é…ç½®æŒ‡å—ï¼š[docs/configuration-guide.md](docs/configuration-guide.md)

#### æ­¥éª¤ 2ï¼šåˆ›å»ºä¼šè¯å¹¶å‘é€è¯·æ±‚

```bash
curl -N http://localhost:3000/mcp/fetch \
  -H "Authorization: Bearer your-secret-token-here" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json, text/event-stream" \
  -d '[
    {"jsonrpc":"2.0","id":"1","method":"tools/list","params":{}}
  ]'
```

**å“åº”ç¤ºä¾‹**ï¼ˆSSE æ ¼å¼ï¼‰ï¼š

```
event: message
id: 1
data: {"jsonrpc":"2.0","id":"1","result":{"tools":[...]}}
```

å“åº”å¤´ä¼šåŒ…å« `mcp-session-id: xxx-xxx-xxx`ï¼Œç”¨äºåç»­è¯·æ±‚ã€‚

#### æ­¥éª¤ 3ï¼šå¤ç”¨ä¼šè¯

```bash
curl -N http://localhost:3000/mcp/fetch \
  -H "Authorization: Bearer your-secret-token-here" \
  -H "mcp-session-id: xxx-xxx-xxx" \
  -H "Accept: application/json, text/event-stream" \
  -d '[
    {"jsonrpc":"2.0","id":"2","method":"tools/call","params":{...}}
  ]'
```

#### æ­¥éª¤ 4ï¼šä¸»åŠ¨å…³é—­ä¼šè¯ï¼ˆå¯é€‰ï¼‰

```bash
curl -X DELETE http://localhost:3000/mcp/fetch \
  -H "Authorization: Bearer your-secret-token-here" \
  -H "mcp-session-id: xxx-xxx-xxx"
```

**ğŸ’¡ æç¤º**ï¼šä¼šè¯ç©ºé—² 5 åˆ†é’Ÿåä¼šè‡ªåŠ¨å›æ”¶ï¼ˆå¯é€šè¿‡ `STREAM_SESSION_TTL_MS` é…ç½®ï¼‰ã€‚

---

### æ¨¡å¼äºŒï¼šç»å…¸æ¡¥æ¥æ–¹å¼

éå®˜æ–¹æ ‡å‡†çš„è°ƒç”¨æ–¹å¼ï¼Œéœ€è¦è‡ªå·±å®ç° tools/list, tools/call ç­‰å…·ä½“çš„æ–¹æ³•

#### ç¤ºä¾‹ 1ï¼šåˆ—å‡ºå¯ç”¨å·¥å…·

```bash
curl -X POST http://localhost:3000/bridge \
  -H "Authorization: Bearer your-secret-token-here" \
  -H "Content-Type: application/json" \
  -d '{
    "serverPath": "uvx",
    "args": ["mcp-server-fetch"],
    "method": "tools/list",
    "params": {}
  }'
```

#### ç¤ºä¾‹ 2ï¼šè°ƒç”¨å·¥å…·

```bash
curl -X POST http://localhost:3000/bridge \
  -H "Authorization: Bearer your-secret-token-here" \
  -H "Content-Type: application/json" \
  -d '{
    "serverPath": "uvx",
    "args": ["mcp-server-fetch"],
    "method": "tools/call",
    "params": {
      "name": "fetch",
      "arguments": {
        "url": "https://example.com"
      }
    }
  }'
```

---

## ğŸ”§ é…ç½®å‚æ•°

### ç¯å¢ƒå˜é‡

| ç¯å¢ƒå˜é‡ | é»˜è®¤å€¼ | è¯´æ˜ |
|---------|--------|------|
| `PORT` | `3000` | HTTP æœåŠ¡ç«¯å£ |
| `AUTH_TOKEN` | - | API è®¿é—®ä»¤ç‰Œï¼ˆå¼ºçƒˆå»ºè®®è®¾ç½®ï¼‰ |
| `ALLOWED_ORIGINS` | - | CORS ç™½åå•ï¼Œé€—å·åˆ†éš”ï¼ˆå¦‚ `https://app.com,https://api.com`ï¼‰ |
| `LOG_LEVEL` | `INFO` | æ—¥å¿—çº§åˆ«ï¼ˆ`DEBUG`ã€`INFO`ã€`WARN`ã€`ERROR`ï¼‰ |
| `STREAM_SESSION_TTL_MS` | `300000` | æµå¼ä¼šè¯ç©ºé—²è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰ |
| `NGROK_AUTH_TOKEN` | - | Ngrok è®¤è¯ä»¤ç‰Œ |

### MCP æœåŠ¡å™¨é…ç½®

**æ¨èï¼šä½¿ç”¨ YAML é…ç½®æ–‡ä»¶**

åˆ›å»º `mcp-servers.yaml`ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰ï¼š

```yaml
servers:
  server-name:
    command: "å¯æ‰§è¡Œå‘½ä»¤"
    args: ["å‚æ•°1", "å‚æ•°2"]           # å¯é€‰
    env:                               # å¯é€‰
      KEY: "value"
      SECRET: ${ENV_VAR}              # å¼•ç”¨ç¯å¢ƒå˜é‡
    description: "æœåŠ¡å™¨æè¿°"          # å¯é€‰
    timeout: 30000                     # å¯é€‰ï¼ˆæ¯«ç§’ï¼‰
    retries: 3                         # å¯é€‰ï¼ˆé‡è¯•æ¬¡æ•°ï¼‰
```

**é…ç½®ä¼˜å…ˆçº§**ï¼š
1. `mcp-servers.yaml` â† æœ€é«˜ä¼˜å…ˆçº§
2. `mcp-servers.yml`
3. `mcp-servers.json`
4. `MCP_SERVERS` ç¯å¢ƒå˜é‡ â† å…¼å®¹æ—§ç‰ˆæœ¬

**é…ç½®ç¤ºä¾‹**ï¼š

<details>
<summary>æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹</summary>

```yaml
servers:
  # ç®€å•é…ç½®
  fetch:
    command: uvx
    args: [mcp-server-fetch]

  # å¸¦ç¯å¢ƒå˜é‡
  github:
    command: npx
    args: [-y, "@modelcontextprotocol/server-github"]
    env:
      GITHUB_PERSONAL_ACCESS_TOKEN: ${GITHUB_TOKEN}

  # å®Œæ•´é…ç½®
  database:
    command: /usr/local/bin/db-mcp-server
    args: ["--host", "localhost"]
    env:
      DATABASE_URL: postgresql://${DB_USER}:${DB_PASS}@localhost/mydb
    description: "PostgreSQL æ•°æ®åº“è®¿é—®"
    timeout: 60000
    retries: 3
```

</details>

> ğŸ“– **è¯¦ç»†é…ç½®æŒ‡å—**ï¼š[docs/configuration-guide.md](docs/configuration-guide.md)

---

## ğŸ› ï¸ API å‚è€ƒ

### `GET /health`

å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼ˆæ— éœ€è®¤è¯ï¼‰

**å“åº”**ï¼š
```json
{"status": "ok"}
```

---

### `POST /bridge`

çŸ­è¿æ¥æ¡¥æ¥æ¨¡å¼

**è¯·æ±‚å¤´**ï¼š
- `Authorization: Bearer <token>`ï¼ˆå¦‚å·²è®¾ç½® `ACCESS_TOKEN`ï¼‰
- `Content-Type: application/json`

**è¯·æ±‚ä½“**ï¼š
```json
{
  "serverPath": "å¯æ‰§è¡Œå‘½ä»¤æˆ– URLï¼ˆhttp/https/ws/wssï¼‰",
  "method": "JSON-RPC æ–¹æ³•å",
  "params": {},
  "args": ["å¯é€‰çš„å‘½ä»¤è¡Œå‚æ•°"],
  "env": {"å¯é€‰çš„ç¯å¢ƒå˜é‡": "å€¼"}
}
```

**æ”¯æŒçš„æ–¹æ³•**ï¼š
- `tools/list`ã€`tools/call`
- `prompts/list`ã€`prompts/get`
- `resources/list`ã€`resources/read`
- `resources/subscribe`ã€`resources/unsubscribe`
- `completion/complete`
- `logging/setLevel`

---

### `POST /mcp/:serverId`

æµå¼ä¼šè¯æ¨¡å¼

**è·¯å¾„å‚æ•°**ï¼š
- `serverId`ï¼šåœ¨ `MCP_SERVERS` ä¸­å®šä¹‰çš„æœåŠ¡å™¨ ID

**è¯·æ±‚å¤´**ï¼š
- `Authorization: Bearer <token>`
- `Accept: application/json, text/event-stream`ï¼ˆå¿…é¡»ï¼‰
- `mcp-session-id: <session-id>`ï¼ˆå¯é€‰ï¼Œå¤ç”¨å·²æœ‰ä¼šè¯ï¼‰

**è¯·æ±‚ä½“**ï¼š
```json
[
  {"jsonrpc":"2.0","id":"1","method":"tools/list","params":{}},
  {"jsonrpc":"2.0","method":"notifications/initialized"}
]
```

**å“åº”**ï¼š
- å¦‚æœ‰è¯·æ±‚ï¼ˆå¸¦ `id`ï¼‰ï¼šè¿”å› SSE æµ
- ä»…é€šçŸ¥ï¼ˆæ—  `id`ï¼‰ï¼šè¿”å› `202 Accepted`

---

### `DELETE /mcp/:serverId`

å…³é—­ä¼šè¯

**è¯·æ±‚å¤´**ï¼š
- `mcp-session-id: <session-id>`ï¼ˆå¿…é¡»ï¼‰

**å“åº”**ï¼š`204 No Content`

---

## ğŸŒ å¤–ç½‘è®¿é—®ï¼ˆNgrokï¼‰

1. è·å– Ngrok ä»¤ç‰Œï¼šhttps://dashboard.ngrok.com/get-started/your-authtoken

2. æ·»åŠ åˆ° `.env`ï¼š
   ```env
   NGROK_AUTH_TOKEN=your-token-here
   ```

3. å¯åŠ¨æœåŠ¡ï¼š
   ```bash
   npm run start:tunnel
   ```

4. æ§åˆ¶å°ä¼šæ˜¾ç¤ºå…¬ç½‘åœ°å€ï¼š
   ```
   Tunnel URL: https://abc123.ngrok.io
   MCP Bridge URL: https://abc123.ngrok.io/bridge
   ```

---

## ğŸ”’ å®‰å…¨å»ºè®®

1. **âš ï¸ å¿…é¡»è®¾ç½® `ACCESS_TOKEN`**
   æœªè®¾ç½®ä¼šæœ‰è­¦å‘Šæ—¥å¿—ï¼Œç”Ÿäº§ç¯å¢ƒç¦æ­¢ä¸è®¾ä»¤ç‰Œ

2. **é…ç½® `ALLOWED_ORIGINS`**
   é™åˆ¶è·¨åŸŸè¯·æ±‚æ¥æºï¼š
   ```env
   ALLOWED_ORIGINS=https://yourdomain.com,https://app.yourdomain.com
   ```

3. **ä½¿ç”¨ HTTPS**
   ç”Ÿäº§ç¯å¢ƒå»ºè®®é€šè¿‡åå‘ä»£ç†ï¼ˆNginxã€Caddyï¼‰æ·»åŠ  SSL

4. **å®šæœŸè½®æ¢ä»¤ç‰Œ**
   ä½¿ç”¨å¼ºéšæœºä»¤ç‰Œï¼Œå®šæœŸæ›´æ–°

5. **å®¡è®¡æ—¥å¿—**
   æ£€æŸ¥ `error.log` å’Œ `combined.log` ä¸­çš„å¼‚å¸¸è®¿é—®

---

## ğŸ“Š æ—¥å¿—ä¸ç›‘æ§

### æ—¥å¿—æ–‡ä»¶

- `combined.log`ï¼šæ‰€æœ‰çº§åˆ«æ—¥å¿—
- `error.log`ï¼šä»…é”™è¯¯çº§åˆ«

### æ—¥å¿—çº§åˆ«

é€šè¿‡ `LOG_LEVEL` æ§åˆ¶è¯¦ç»†ç¨‹åº¦ï¼š

```env
LOG_LEVEL=DEBUG  # å¼€å‘ç¯å¢ƒ
LOG_LEVEL=INFO   # ç”Ÿäº§ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰
LOG_LEVEL=WARN   # ä»…è­¦å‘Šå’Œé”™è¯¯
```

### å¥åº·æ£€æŸ¥

```bash
# æœ¬åœ°æ£€æŸ¥
curl http://localhost:3000/health

# é…åˆç›‘æ§å·¥å…·ï¼ˆå¦‚ UptimeRobotã€Prometheusï¼‰
# æ¯ 30 ç§’è‡ªåŠ¨æ£€æŸ¥ä¸€æ¬¡
```

---

## ğŸ§ª å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ server/
â”‚   â””â”€â”€ http-server.ts      # HTTP æœåŠ¡å™¨å’Œè·¯ç”±
â”œâ”€â”€ client/
â”‚   â””â”€â”€ mcp-client-manager.ts  # MCP å®¢æˆ·ç«¯ç®¡ç†
â”œâ”€â”€ stream/
â”‚   â”œâ”€â”€ session-manager.ts   # ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚   â””â”€â”€ stream-session.ts    # SSE ä¼šè¯å®ç°
â”œâ”€â”€ config/
â”‚   â””â”€â”€ config.ts            # é…ç½®åŠ è½½å’Œæ ¡éªŒ
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ logger.ts            # Winston æ—¥å¿—å™¨
â”‚   â””â”€â”€ tunnel.ts            # Ngrok éš§é“ç®¡ç†
â””â”€â”€ index.ts                 # å…¥å£æ–‡ä»¶
```

### å¼€å‘å‘½ä»¤

```bash
# çƒ­é‡è½½å¼€å‘
npm run dev

# ä»£ç æ£€æŸ¥
npm run lint

# è¿è¡Œæµ‹è¯•
npm test

# ç±»å‹æ£€æŸ¥
npx tsc --noEmit
```

### ç¼–ç è§„èŒƒ

- **è¯­è¨€**ï¼šTypeScriptï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰
- **ç¼©è¿›**ï¼š2 ç©ºæ ¼
- **å‘½å**ï¼š
  - å‡½æ•°/å˜é‡ï¼š`camelCase`
  - ç±»ï¼š`PascalCase`
  - æ–‡ä»¶ï¼š`kebab-case.ts`
- **å¯¼å‡º**ï¼šä¼˜å…ˆä½¿ç”¨å‘½åå¯¼å‡º

---

## â“ å¸¸è§é—®é¢˜

<details>
<summary><b>Q: ä¸ºä»€ä¹ˆè¿”å› 401 Unauthorizedï¼Ÿ</b></summary>

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. æ˜¯å¦è®¾ç½®äº† `ACCESS_TOKEN` ç¯å¢ƒå˜é‡
2. è¯·æ±‚å¤´æ˜¯å¦åŒ…å« `Authorization: Bearer <token>`
3. Token æ˜¯å¦åŒ¹é…ï¼ˆæ³¨æ„ç©ºæ ¼å’Œç‰¹æ®Šå­—ç¬¦ï¼‰
</details>

<details>
<summary><b>Q: è¿”å› 403 Origin not allowed æ€ä¹ˆåŠï¼Ÿ</b></summary>

**A**: å°†è¯·æ±‚æ¥æºæ·»åŠ åˆ°ç™½åå•ï¼š
```env
ALLOWED_ORIGINS=https://your-frontend-domain.com
```
</details>

<details>
<summary><b>Q: 404 Unknown MCP server é”™è¯¯</b></summary>

**A**: æ£€æŸ¥ `MCP_SERVERS` é…ç½®ï¼š
1. JSON æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆåŒå¼•å·ã€æ— å°¾éšé€—å·ï¼‰
2. `serverId` æ˜¯å¦å­˜åœ¨äºé…ç½®ä¸­
3. ç¤ºä¾‹ï¼š`MCP_SERVERS={"fetch":{"command":"uvx","args":["mcp-server-fetch"]}}`
</details>

<details>
<summary><b>Q: ä¼šè¯è¶…æ—¶æ€ä¹ˆåŠï¼Ÿ</b></summary>

**A**: ä¼šè¯ç©ºé—² 5 åˆ†é’Ÿåè‡ªåŠ¨å…³é—­ï¼Œå¯è°ƒæ•´ï¼š
```env
STREAM_SESSION_TTL_MS=600000  # æ”¹ä¸º 10 åˆ†é’Ÿ
```
</details>

<details>
<summary><b>Q: å¦‚ä½•è°ƒè¯• MCP æœåŠ¡å™¨å¯åŠ¨é—®é¢˜ï¼Ÿ</b></summary>

**A**:
1. è®¾ç½® `LOG_LEVEL=DEBUG` æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
2. æ£€æŸ¥ MCP æœåŠ¡å™¨å‘½ä»¤æ˜¯å¦å¯æ‰§è¡Œï¼ˆæ‰‹åŠ¨è¿è¡Œæµ‹è¯•ï¼‰
3. æŸ¥çœ‹ `error.log` ä¸­çš„é”™è¯¯å †æ ˆ
</details>

---

## ğŸ—ºï¸ è·¯çº¿å›¾

- [ ] æ·»åŠ å®Œæ•´çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- [ ] æ”¯æŒ Prometheus metrics
- [ ] WebSocket åŒå‘æµå¼ä¼ è¾“
- [ ] é…ç½®æ–‡ä»¶çƒ­é‡è½½
- [ ] Docker é•œåƒå’Œ Kubernetes Helm Chart
- [ ] OpenAPI/Swagger æ–‡æ¡£
- [ ] å¤šç§Ÿæˆ·éš”ç¦»

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### æäº¤ PR å‰è¯·ï¼š

1. è¿è¡Œ `npm run lint` ç¡®ä¿ä»£ç è§„èŒƒ
2. æ·»åŠ æˆ–æ›´æ–°æµ‹è¯•ç”¨ä¾‹
3. æ›´æ–°ç›¸å…³æ–‡æ¡£
4. åœ¨ PR ä¸­æè¿°æ”¹åŠ¨å’ŒåŸå› 

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºã€‚

---

## ğŸ™ è‡´è°¢

- [Model Context Protocol](https://modelcontextprotocol.io/) - åè®®è§„èŒƒ
- [@modelcontextprotocol/sdk](https://github.com/modelcontextprotocol/sdk) - å®˜æ–¹ SDK
- [Ngrok](https://ngrok.com/) - éš§é“æœåŠ¡
- [Express.js](https://expressjs.com/) - Web æ¡†æ¶
- [Winston](https://github.com/winstonjs/winston) - æ—¥å¿—åº“

---

<div align="center">

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª â­ï¸ Starï¼**

Made with â¤ï¸ by [Your Name](https://github.com/yourusername)

</div>
